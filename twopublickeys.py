from Cryptodome.Util.number import *
from Cryptodome.Cipher import AES
import hashlib

p = 792321885721039223055203621511476008103176341524490283402628477451813722842720337402795900165653052271349918359044973129279701490613980973589891701136745034631765803279015068621842643130239591656504870040900517665771748667093361827700044850800239770001931593567314982414093813968959529405924117755593099360943
g = 3
pk1 = 710875014521586133177240861275411954502274981112927572082940815173504661025454567548435293794165742619652743188632359986402946530631590657230251177397188927619054747566071728206203495270418156469763404027680754983935556040450591504717450568526386336795569263884391363832901921960805323527167470059092379137922
pk2 = 86808717570366690208001322718928001766858235317780650665971099731639395880622394873399919913452383015375795777766992061856799882891724137587626812205996726126687214822649405836057948017691771588599930195656541971950599498351114597484248265928053509884368193792562548264605997357667468561252551939668866774122

# we find x by using pohlig_solver.py
x = 118898804171878925839912123750057549743062926005973178554285175816990158805736359661465544991426312070354595216379464175639678126679110061781133157437386536831317658523048592374262911563125694940818802105359116761075639790351352187161225004958612068139683894289148609923652322130529479173680203590112151661198
secretNum = pow(pk2, x, p)

print("a =", secretNum)
skh = hashlib.sha256(long_to_bytes(secretNum)).digest()
IV = bytes.fromhex("631ff440abb855a36f856fc5b417cb29")

cipher = AES.new(skh, IV=IV, mode=AES.MODE_CBC)

ciphertext_hex = bytes.fromhex("2e794553fe3f29d5225d44a1319f1ee693a316f57e2335a4d3dc75c444490e36d53cb4f8eb463abdc2f3a0e880e64600")

testcipher = AES.new(skh, IV=IV, mode=AES.MODE_CBC)
print(testcipher.decrypt(ciphertext_hex))
